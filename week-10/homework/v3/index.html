<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Horizon Generator</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- P5.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <!-- TensorFlow.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>

    <style>
      /* Custom slider styles */
      input[type='range'].slider {
        -webkit-appearance: none;
        appearance: none;
        background: transparent;
        cursor: pointer;
      }

      /* Slider track */
      input[type='range'].slider::-webkit-slider-track {
        background: #374151;
        height: 4px;
        border-radius: 2px;
      }

      input[type='range'].slider::-moz-range-track {
        background: #374151;
        height: 4px;
        border-radius: 2px;
      }

      /* Slider thumb */
      input[type='range'].slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        background: #ffffff;
        height: 12px;
        width: 12px;
        border-radius: 50%;
        margin-top: -4px;
      }

      input[type='range'].slider::-moz-range-thumb {
        background: #ffffff;
        height: 12px;
        width: 12px;
        border-radius: 50%;
        border: none;
      }

      input[type='range'].slider:hover::-webkit-slider-thumb {
        background: #e5e7eb;
      }

      input[type='range'].slider:hover::-moz-range-thumb {
        background: #e5e7eb;
      }

      /* Frame thumbnails */
      .frame-thumb {
        display: inline-block;
        height: 100%;
        border: 2px solid transparent;
        cursor: pointer;
        transition: all 0.2s;
        position: relative;
      }

      .frame-thumb:hover {
        border-color: rgba(255, 50, 50, 0.8);
        transform: scale(0.95);
        filter: saturate(0%) brightness(0.5);
      }

      .frame-thumb:hover::after {
        content: 'Ã—';
        position: absolute;
        top: 2px;
        right: 2px;
        width: 20px;
        height: 20px;
        background: rgba(255, 50, 50, 0.9);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        font-weight: bold;
        line-height: 1;
      }

      .frame-thumb.active {
        border-color: white;
      }

      /* Dropping animation for new frames */
      @keyframes dropIn {
        0% {
          transform: translateY(-100%) scale(0.8);
          opacity: 0;
        }
        50% {
          transform: scale(1.05);
          opacity: 0.8;
        }
        70% {
          transform: translateY(-5%) scale(0.98);
        }
        100% {
          transform: translateY(0) scale(1);
          opacity: 1;
        }
      }

      .frame-thumb.dropping {
        animation: dropIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      }

      /* Animation overlay */
      #animation-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 10;
      }
    </style>
  </head>
  <body
    class="bg-black text-white min-h-screen flex items-center justify-center flex-col"
  >
    <div class="text-center">
      <div class="p-1 border-2 border-white/20 bg-neutral-900/20">
        <div class="p-1 border-2 border-white/40 bg-neutral-900/20">
          <div class="p-1 border-2 border-white/60 bg-neutral-800/20">
            <div class="p-1 border-2 border-white/80 bg-neutral-800/20">
              <div class="overflow-hidden border-2 border-white relative">
                <!-- The p5.js canvas will be automatically inserted here -->
                <div id="canvas-container"></div>
                <!-- Animation overlay -->
                <img id="animation-overlay" style="display: none" />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <button
      id="capture-btn"
      class="transition-colors bg-transparent p-1 m-1 rounded-full hover:bg-white/10 active:bg-white/20 focus:outline-none block border-none cursor-pointer"
      type="button"
      aria-label="More"
    >
      <svg
        width="32"
        height="32"
        viewBox="0 0 32 32"
        aria-hidden="true"
        style="display: block; margin: auto"
      >
        <polyline
          points="8,14 16,22 24,14"
          fill="none"
          stroke="#888888"
          stroke-width="3"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </button>
    <div class="text-center w-full max-w-lg">
      <div class="p-1 border-2 border-white/20 bg-neutral-900/20">
        <div class="p-1 border-2 border-white/40 bg-neutral-900/20">
          <div class="p-1 border-2 border-white/60 bg-neutral-800/20">
            <div class="p-1 border-2 border-white/80 bg-neutral-800/20">
              <div class="overflow-hidden border-2 border-white">
                <!-- The p5.js canvas will be automatically inserted here -->
                <div
                  id="frame-container"
                  class="h-24 w-full overflow-x-auto whitespace-nowrap flex items-center justify-start"
                ></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Play/Stop Button -->
      <button
        id="play-btn"
        class="mt-2 px-2 py-2 bg-white/10 border-2 hover:bg-white/20 text-white text-sm rounded-full transition-colors flex items-center gap-2 mx-auto"
        type="button"
        aria-label="Play/Stop Animation"
      >
        <svg
          id="play-icon"
          width="16"
          height="16"
          viewBox="0 0 16 16"
          fill="currentColor"
        >
          <path d="M4 2v12l10-6z" />
        </svg>
        <svg
          id="stop-icon"
          width="16"
          height="16"
          viewBox="0 0 16 16"
          fill="currentColor"
          style="display: none"
        >
          <rect x="3" y="3" width="10" height="10" />
        </svg>
        <span id="play-btn-text" class="hidden">Play Animation</span>
      </button>
    </div>

    <!-- Context Menu -->
    <div
      id="context-menu"
      class="fixed hidden bg-neutral-900 border border-white/30 shadow-2xl z-50 py-1 min-w-[180px]"
    >
      <button
        class="context-menu-item w-full text-xs text-left px-2 py-1 hover:bg-white/10 flex items-center justify-between group"
        data-action="clear"
      >
        <span>Clear Canvas</span>
        <span class="text-xs text-gray-400 group-hover:text-gray-300">C</span>
      </button>
      <button
        class="context-menu-item w-full text-xs text-left px-2 py-1 hover:bg-white/10 flex items-center justify-between group"
        data-action="random"
      >
        <span>Random Seascape</span>
        <span class="text-xs text-gray-400 group-hover:text-gray-300">R</span>
      </button>
      <div class="border-t border-white/20 my-1"></div>
      <div class="px-2 py-2">
        <div
          class="flex items-center justify-between text-xs text-gray-400 mb-2"
        >
          <span>Brush Size</span>
          <span id="brush-size-value" class="text-white">1px</span>
        </div>
        <input
          type="range"
          id="brush-size-slider"
          min="1"
          max="10"
          value="1"
          class="w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer slider"
          style="
            background: linear-gradient(
              to right,
              #ffffff 0%,
              #ffffff 10%,
              #4b5563 10%,
              #4b5563 100%
            );
          "
        />
        <div class="flex justify-between text-xs text-gray-500 mt-1">
          <span>1</span>
          <span>5</span>
          <span>10</span>
        </div>
      </div>
      <div class="border-t border-white/20 my-1"></div>
      <button
        class="context-menu-item w-full text-xs text-left px-2 py-1 hover:bg-white/10 flex items-center justify-between group"
        data-action="save"
      >
        <span>Save Image</span>
        <span class="text-xs text-gray-400 group-hover:text-gray-300">S</span>
      </button>
    </div>

    <!-- Link to your p5.js script -->
    <script src="script.js"></script>
  </body>
</html>
